<?xml version="1.0" encoding="UTF-8"?>
<!-- ======================================================================
     terasoluna-filedao_バージョン番号.zipを生成するビルドファイル。
     OSS リリース用
     ====================================================================== -->
<project name="terasoluna-filedao" default="createAll" basedir="..">
  <property file="./ant/build.properties" />
  <property name="lib.dir" value="${terasoluna.lib.home}/lib"/>
  <property name="terasoluna.lib.dir" value="${terasoluna.lib.home}/dist"/>
  <tstamp/>

  <!-- =================================
        このプロジェクトをZipファイルにしてdistフォルダに格納する。
       ================================= -->
  <target name="createAll" depends="buildJar,buildCreateSourceZip,buildCreateJavaDocZip">
  	<rename dest="./temp.classpath" 
  		src="./.classpath"/>
  	<rename dest="./.classpath" 
  		src="./noTest.classpath"/>
  	<delete file="${dist.dir}/${ant.project.name}_${terasoluna.version}.zip"/>
  	<mkdir dir="${dist.dir}"/>
   	<zip destfile="${dist.dir}/${ant.project.name}.zip">
	  <fileset dir="${basedir}/..">
	    <include name="${ant.project.name}/.classpath"/>
	  	<include name="${ant.project.name}/.project"/>
	  	<include name="${ant.project.name}/LICENSE.txt"/>
	  	<include name="${ant.project.name}/sources/**/*"/>
	  	<include name="${ant.project.name}/ant/build.xml"/>
	  	<include name="${ant.project.name}/ant/build.properties"/>
	  </fileset>
    </zip>
  	<rename dest="${dist.dir}/${ant.project.name}_${terasoluna.version}.zip" 
  		src="${dist.dir}/${ant.project.name}.zip"/>
  	<rename dest="./noTest.classpath" 
  		src="./.classpath"/>
  	<rename dest="./.classpath" 
  		src="./temp.classpath"/>
  </target>
	
  <target name="buildJar" description="terasoluna-filedao.jarを生成する。" >
  	<ant antfile="./ant/build.xml" target="jar" inheritall="false"/>
  </target>

  <target name="buildCreateSourceZip" description="${src.zip.filedao}_${terasoluna.version}.zipを生成する。" >
  	<ant antfile="./ant/build.xml" target="createSourceZip" inheritall="false"/>
  </target>

  <target name="buildCreateJavaDocZip" description="${filedao.javadoc.name}_${terasoluna.version}.zipを生成する。" >
  	<ant antfile="./ant/build.xml" target="createJavaDocZip" inheritall="false"/>
  </target>
</project>